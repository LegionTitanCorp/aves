<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Rompecabezas de Aves - Conservaci√≥n y Diversidad</title>
<style>
    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
    }

    body {
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
        color: #333;
        line-height: 1.6;
    }

    .container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 20px;
    }

    header {
        text-align: center;
        margin-bottom: 40px;
        background: rgba(255, 255, 255, 0.95);
        padding: 30px;
        border-radius: 20px;
        box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
        backdrop-filter: blur(10px);
    }

    h1 {
        font-size: 3em;
        color: #2c3e50;
        margin-bottom: 10px;
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
        background: linear-gradient(45deg, #3498db, #2ecc71);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
    }

    .subtitle {
        font-size: 1.2em;
        color: #7f8c8d;
        margin-bottom: 20px;
    }

    .info-section {
        background: rgba(255, 255, 255, 0.9);
        padding: 20px;
        border-radius: 15px;
        margin-bottom: 30px;
        box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
        transition: transform 0.3s ease;
    }

    .info-section:hover {
        transform: translateY(-5px);
    }

    .game-container {
        display: grid;
        grid-template-columns: 1fr 400px;
        gap: 40px;
        margin-bottom: 40px;
    }

    .puzzle-area {
        background: rgba(255, 255, 255, 0.95);
        padding: 30px;
        border-radius: 20px;
        box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
        text-align: center;
    }

    #puzzle {
        display: grid;
        grid-template-columns: repeat(3, 120px);
        grid-template-rows: repeat(3, 120px);
        gap: 3px;
        margin: 20px auto;
        width: max-content;
        background: #34495e;
        padding: 15px;
        border-radius: 15px;
        box-shadow: inset 0 0 20px rgba(0, 0, 0, 0.2);
    }

    .piece {
        width: 120px;
        height: 120px;
        background-size: 360px 360px;
        border: 3px solid #fff;
        border-radius: 8px;
        cursor: grab;
        transition: all 0.3s ease;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        position: relative;
        overflow: hidden;
        background-color: #f8f9fa;
    }

    .piece:hover {
        transform: scale(1.05);
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
        z-index: 10;
    }

    .piece:active {
        cursor: grabbing;
        transform: rotate(5deg);
    }

    .piece::after {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: linear-gradient(45deg, transparent 30%, rgba(255, 255, 255, 0.1) 50%, transparent 70%);
        opacity: 0;
        transition: opacity 0.3s ease;
    }

    .piece:hover::after {
        opacity: 1;
    }

    .game-info {
        background: rgba(255, 255, 255, 0.95);
        padding: 30px;
        border-radius: 20px;
        box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
    }

    .current-bird {
        text-align: center;
        margin-bottom: 20px;
    }

    .bird-preview {
        width: 200px;
        height: 200px;
        margin: 0 auto 15px;
        border-radius: 15px;
        box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
        background-size: cover;
        background-position: center;
        background-color: #f8f9fa;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 3em;
        color: #7f8c8d;
    }

    .bird-name {
        font-size: 1.3em;
        font-weight: bold;
        color: #2c3e50;
        margin-bottom: 10px;
    }

    .bird-description {
        font-size: 0.9em;
        color: #7f8c8d;
        text-align: left;
        line-height: 1.5;
    }

    .controls {
        display: flex;
        justify-content: center;
        gap: 15px;
        margin: 20px 0;
        flex-wrap: wrap;
    }

    button {
        padding: 12px 24px;
        font-size: 16px;
        cursor: pointer;
        border: none;
        border-radius: 25px;
        font-weight: bold;
        text-transform: uppercase;
        letter-spacing: 1px;
        transition: all 0.3s ease;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        position: relative;
        overflow: hidden;
    }

    .btn-primary {
        background: linear-gradient(45deg, #3498db, #2ecc71);
        color: white;
    }

    .btn-secondary {
        background: linear-gradient(45deg, #e74c3c, #f39c12);
        color: white;
    }

    .btn-info {
        background: linear-gradient(45deg, #9b59b6, #e91e63);
        color: white;
    }

    button:hover {
        transform: translateY(-3px);
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
    }

    button:active {
        transform: translateY(-1px);
    }

    button:disabled {
        background: #bdc3c7;
        cursor: not-allowed;
        transform: none;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
    }

    #mensaje {
        margin: 20px 0;
        font-weight: bold;
        font-size: 1.2em;
        text-align: center;
        padding: 15px;
        border-radius: 10px;
        transition: all 0.3s ease;
    }

    .success {
        background: linear-gradient(45deg, #2ecc71, #27ae60);
        color: white;
        box-shadow: 0 5px 15px rgba(46, 204, 113, 0.4);
        animation: pulse 1.5s infinite;
    }

    .error {
        background: linear-gradient(45deg, #e74c3c, #c0392b);
        color: white;
        box-shadow: 0 5px 15px rgba(231, 76, 60, 0.4);
    }

    .warning {
        background: linear-gradient(45deg, #f39c12, #e67e22);
        color: white;
        box-shadow: 0 5px 15px rgba(243, 156, 18, 0.4);
    }

    @keyframes pulse {
        0% { transform: scale(1); }
        50% { transform: scale(1.05); }
        100% { transform: scale(1); }
    }

    .stats {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
        gap: 15px;
        margin: 20px 0;
    }

    .stat-item {
        background: rgba(52, 73, 94, 0.1);
        padding: 15px;
        border-radius: 10px;
        text-align: center;
    }

    .stat-number {
        font-size: 2em;
        font-weight: bold;
        color: #3498db;
    }

    .stat-label {
        font-size: 0.9em;
        color: #7f8c8d;
        text-transform: uppercase;
        letter-spacing: 1px;
    }

    .bird-facts {
        background: rgba(255, 255, 255, 0.9);
        padding: 25px;
        border-radius: 15px;
        margin-top: 30px;
        box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
    }

    .fact-item {
        display: flex;
        align-items: center;
        margin: 15px 0;
        padding: 10px;
        background: rgba(52, 152, 219, 0.1);
        border-radius: 8px;
        border-left: 4px solid #3498db;
    }

    .fact-icon {
        font-size: 1.5em;
        margin-right: 15px;
        color: #3498db;
    }

    .timer {
        background: linear-gradient(45deg, #f39c12, #e67e22);
        color: white;
        padding: 10px 20px;
        border-radius: 20px;
        font-weight: bold;
        font-size: 1.1em;
        box-shadow: 0 5px 15px rgba(243, 156, 18, 0.3);
    }

    .difficulty-selector {
        margin: 20px 0;
        text-align: center;
    }

    .difficulty-btn {
        margin: 5px;
        padding: 8px 16px;
        font-size: 14px;
    }

    .difficulty-btn.active {
        background: linear-gradient(45deg, #2c3e50, #34495e);
        color: white;
    }

    .bird-gallery {
        background: rgba(255, 255, 255, 0.9);
        padding: 25px;
        border-radius: 15px;
        margin-top: 30px;
        box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
    }

    .gallery-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 20px;
        margin-top: 20px;
    }

    .gallery-item {
        background: #f8f9fa;
        border-radius: 15px;
        padding: 20px;
        text-align: center;
        cursor: pointer;
        transition: all 0.3s ease;
        border: 2px solid transparent;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
    }

    .gallery-item:hover {
        transform: translateY(-5px);
        border-color: #3498db;
        background: #e3f2fd;
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
    }

    .gallery-item.selected {
        border-color: #2ecc71;
        background: #e8f5e8;
        box-shadow: 0 10px 25px rgba(46, 204, 113, 0.3);
    }

    .gallery-item.unavailable {
        opacity: 0.5;
        cursor: not-allowed;
        background: #ecf0f1;
    }

    .gallery-item.unavailable:hover {
        transform: none;
        border-color: transparent;
        background: #ecf0f1;
    }

    .gallery-icon {
        font-size: 3em;
        margin-bottom: 15px;
        display: block;
    }

    .gallery-name {
        font-size: 1.1em;
        font-weight: bold;
        color: #2c3e50;
        margin-bottom: 5px;
    }

    .gallery-status {
        font-size: 0.8em;
        color: #7f8c8d;
        margin-top: 5px;
    }

    .available {
        color: #27ae60;
        font-weight: bold;
    }

    .unavailable-text {
        color: #e74c3c;
    }

    @media (max-width: 768px) {
        .game-container {
            grid-template-columns: 1fr;
            gap: 20px;
        }
        
        #puzzle {
            grid-template-columns: repeat(3, 90px);
            grid-template-rows: repeat(3, 90px);
        }
        
        .piece {
            width: 90px;
            height: 90px;
            background-size: 270px 270px;
        }
        
        h1 {
            font-size: 2em;
        }
        
        .controls {
            flex-direction: column;
            align-items: center;
        }
        
        button {
            width: 200px;
        }

        .gallery-grid {
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
        }
    }

    @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
    }

    @keyframes fall {
        to {
            transform: translateY(100vh) rotate(360deg);
            opacity: 0;
        }
    }

    .loading {
        display: inline-block;
        animation: spin 1s linear infinite;
    }
</style>
</head>
<body>

<div class="container">
    <header>
        <h1>üê¶ Rompecabezas de Aves</h1>
        <p class="subtitle">Descubre la belleza de las aves mientras juegas y aprendes sobre conservaci√≥n</p>
        
        <div class="stats">
            <div class="stat-item">
                <div class="stat-number" id="puzzles-completed">0</div>
                <div class="stat-label">Completados</div>
            </div>
            <div class="stat-item">
                <div class="stat-number" id="best-time">--:--</div>
                <div class="stat-label">Mejor Tiempo</div>
            </div>
            <div class="stat-item">
                <div class="stat-number" id="moves-count">0</div>
                <div class="stat-label">Movimientos</div>
            </div>
            <div class="stat-item">
                <div class="stat-number" id="available-birds">0</div>
                <div class="stat-label">Disponibles</div>
            </div>
        </div>
    </header>

    <div class="info-section">
        <h2>üåç Importancia de la Conservaci√≥n de Aves</h2>
        <p>Las aves son indicadores vitales de la salud de nuestros ecosistemas. A trav√©s de este juego, no solo te diviertes, sino que tambi√©n aprendes sobre diferentes especies y la importancia de proteger su h√°bitat natural. Cada rompecabezas completado representa una especie √∫nica con caracter√≠sticas fascinantes.</p>
    </div>

    <div class="game-container">
        <div class="puzzle-area">
            <div class="difficulty-selector">
                <h3>Selecciona la dificultad:</h3>
                <button class="difficulty-btn active" onclick="cambiarDificultad(3)">F√°cil (3x3)</button>
                <button class="difficulty-btn" onclick="cambiarDificultad(4)">Medio (4x4)</button>
                <button class="difficulty-btn" onclick="cambiarDificultad(5)">Dif√≠cil (5x5)</button>
            </div>

            <div class="timer" id="timer">‚è±Ô∏è Tiempo: 00:00</div>
            
            <div id="puzzle"></div>
            
            <div id="mensaje">üîÑ Iniciando juego...</div>
            
            <div class="controls">
                <button class="btn-primary" onclick="reiniciarJuego()">üîÑ Reiniciar</button>
                <button class="btn-secondary" onclick="cambiarImagen()">üé≤ Nueva Ave</button>
                <button class="btn-info" onclick="mostrarAyuda()">üí° Ayuda</button>
            </div>
        </div>

        <div class="game-info">
            <div class="current-bird">
                <h3>üê¶ Ave Actual</h3>
                <div class="bird-preview" id="bird-preview">üê¶</div>
                <div class="bird-name" id="bird-name">Cargando...</div>
                <div class="bird-description" id="bird-description">Preparando informaci√≥n de la especie...</div>
            </div>
        </div>
    </div>

    <div class="bird-gallery">
        <h2>ü¶Ö Galer√≠a de Aves</h2>
        <p>Las aves marcadas en <span class="available">verde</span> est√°n disponibles para jugar. Las marcadas en <span class="unavailable-text">rojo</span> requieren que a√±adas sus im√°genes a la carpeta 'imagenes/'.</p>
        <div class="gallery-grid" id="bird-gallery"></div>
    </div>

    <div class="bird-facts">
        <h2>ü¶Ö Datos Fascinantes sobre las Aves</h2>
        <div class="fact-item">
            <div class="fact-icon">üåç</div>
            <div>Existen m√°s de 10,000 especies de aves en el mundo, desde el colibr√≠ abeja de 2g hasta el avestruz de 150kg.</div>
        </div>
        <div class="fact-item">
            <div class="fact-icon">üß≠</div>
            <div>Las aves migratorias pueden viajar miles de kil√≥metros usando campos magn√©ticos, estrellas y puntos de referencia.</div>
        </div>
        <div class="fact-item">
            <div class="fact-icon">üéµ</div>
            <div>Los p√°jaros cantores pueden aprender nuevas melod√≠as y tienen dialectos regionales, como los humanos.</div>
        </div>
        <div class="fact-item">
            <div class="fact-icon">üèóÔ∏è</div>
            <div>Algunas aves, como los cuervos y loros, pueden usar herramientas y resolver problemas complejos.</div>
        </div>
        <div class="fact-item">
            <div class="fact-icon">‚ö°</div>
            <div>El colibr√≠ puede batir sus alas hasta 80 veces por segundo y volar hacia atr√°s.</div>
        </div>
        <div class="fact-item">
            <div class="fact-icon">üèä</div>
            <div>Los ping√ºinos pueden bucear hasta 500 metros de profundidad y contener la respiraci√≥n por 20 minutos.</div>
        </div>
    </div>
</div>

<script>
    // Base de datos de aves con todas las especies disponibles
    const avesData = {
        1: { // √Åguila ratonera pechinegra
        nombre: 'Aguila ratonera pechinegra',
        nombreCientifico: 'Geranoaetus melanoleucus',
        descripcion: 'Ave rapaz de gran tama√±o que habita en las monta√±as andinas. Se caracteriza por su vuelo aerodin√°mico y excelente aislamiento t√©rmico que le permite vivir en altitudes elevadas.',
        habitat: 'Monta√±as andinas, p√°ramos y zonas rocosas',
        tama√±o: '60-70 cm',
        peso: '1.8-2.5 kg',
        icono: 'ü¶Ö',
        categoria: 'Rapaz',
        imagen: 'imagenes/Aguila-ratonera.png'
    },

    2: { // Aguilucho Negro
        nombre: 'Aguilucho Negro',
        nombreCientifico: '-',
        descripcion: 'Ave rapaz elegante conocida por su vuelo aerodin√°mico. Su plumaje oscuro le permite camuflarse entre las rocas andinas mientras caza.',
        habitat: 'Zonas monta√±osas y valles andinos',
        tama√±o: '55-65 cm',
        peso: '1.2-1.8 kg',
        icono: 'ü¶Ö',
        categoria: 'Rapaz',
        imagen: 'imagenes/Aguilucho-negro.png'
    },

    3: { // Avoceta Andina
        nombre: 'Avoceta Andina',
        nombreCientifico: 'Recurvirostra andina',
        descripcion: 'Ave acu√°tica de 40-45 cm con pico curvado caracter√≠stico. Su estado vulnerable requiere especial atenci√≥n para su conservaci√≥n en los humedales andinos.',
        habitat: 'Lagunas salinas y humedales altoandinos',
        tama√±o: '40-45 cm',
        peso: '250-350 g',
        icono: 'ü¶Ü',
        categoria: 'Acu√°tica',
        estado: 'Vulnerable',
        imagen: 'imagenes/Avocetaandina.png'
    },

    4: { // Chorlito de Puna
        nombre: 'Chorlito de Puna',
        nombreCientifico: 'Charadrius alticola',
        descripcion: 'Ave peque√±a que habita en la puna andina. Su poblaci√≥n se mantiene estable y es com√∫n observarla en grupos cerca de cuerpos de agua.',
        habitat: 'Puna, bofedales y orillas de lagunas',
        tama√±o: '18-20 cm',
        peso: '40-60 g',
        icono: 'üê¶',
        categoria: 'Lim√≠cola',
        estado: 'Estable',
        imagen: 'imagenes/Chorlito-pune√±o.jpg'
    },

    5: { // Pato Barcino
        nombre: 'Pato Barcino',
        nombreCientifico: 'Anas flavirostris oxyptera',
        descripcion: 'Pato que prefiere lagunas y tiene un estado poblacional estable. Es com√∫n en humedales andinos y se adapta bien a diferentes altitudes.',
        habitat: 'Lagunas, lagos y humedales',
        tama√±o: '35-40 cm',
        peso: '400-600 g',
        icono: 'ü¶Ü',
        categoria: 'Acu√°tica',
        estado: 'Estable',
        imagen: 'imagenes/Pato-barcino.JPG'
    },

    6: { // Cig√ºe√±uela
        nombre: 'Cig√ºe√±uela',
        nombreCientifico: 'Himantopus mexicanus',
        descripcion: 'Ave zancuda con vuelo √°gil y recto. Su peso ligero de 160-200g le permite maniobrar eficientemente sobre las aguas poco profundas.',
        habitat: 'Humedales, lagunas y pantanos',
        tama√±o: '35-40 cm',
        peso: '160-200 g',
        icono: 'ü¶©',
        categoria: 'Zancuda',
        imagen: 'imagenes/Cigue√±ela-Black.jpg'
    },

    7: { // Gallineta Com√∫n
        nombre: 'Gallineta Comun',
        nombreCientifico: 'Gallinula chloropus',
        descripcion: 'Ave acu√°tica con vuelo corto y r√°pido. Su peso de 250-400g la hace √°gil tanto en el agua como en tierra firme.',
        habitat: 'Lagunas con vegetaci√≥n, pantanos',
        tama√±o: '32-35 cm',
        peso: '250-400 g',
        icono: 'üê¶',
        categoria: 'Acu√°tica',
        imagen: 'imagenes/Gallineta-comun.JPG'
    },

    8: { // Gallinula Morada
        nombre: 'Gallinula Morada',
        nombreCientifico: 'Porphyrio martinicus',
        descripcion: 'Ave de vuelo limitado pero con colorido espectacular usado para el cortejo. Su plumaje morado la hace inconfundible.',
        habitat: 'Humedales con vegetaci√≥n densa',
        tama√±o: '30-35 cm',
        peso: '200-300 g',
        icono: 'üü£',
        categoria: 'Acu√°tica',
        imagen: 'imagenes/Gallinulamorada.png'
    },

    9: { // Garceta Bueyera
        nombre: 'Garceta Bueyera',
        nombreCientifico: 'Bubulcus ibis',
        descripci√≥n: 'Garza con vuelo directo y comportamiento oportunista. Frecuentemente se asocia con ganado para alimentarse de insectos.',
        habitat: 'Pastizales, √°reas ganaderas, humedales',
        tama√±o: '46-56 cm',
        peso: '270-512 g',
        icono: 'ü¶Ü',
        categoria: 'Zancuda',
        imagen: 'imagenes/Garza-bueyera.jpg'
    },

    10: { // Garceta Grande
        nombre: 'Garceta Grande',
        nombreCientifico: 'Ardea alba',
        descripcion: 'Garza de gran tama√±o con vuelo elegante y t√©cnicas de caza sigilosa. Es una de las garzas m√°s grandes de la regi√≥n.',
        habitat: 'Lagos, lagunas y humedales extensos',
        tama√±o: '85-102 cm',
        peso: '700-1500 g',
        icono: 'ü¶Ü',
        categoria: 'Zancuda',
        imagen: 'imagenes/Garza-grande.jpg'
    },

    11: { // Garza Nocturna
        nombre: 'Garza Nocturna',
        nombreCientifico: 'Nycticorax nycticorax',
        descripcion: 'Garza de h√°bitos nocturnos con ojos especialmente adaptados para la caza en condiciones de poca luz.',
        habitat: 'Humedales, lagos con vegetaci√≥n',
        tama√±o: '58-65 cm',
        peso: '727-1014 g',
        icono: 'üåô',
        categoria: 'Zancuda',
        imagen: 'imagenes/Garzanocturna.png'
    },

    12: { // Gavil√°n Dorsirrojo
        nombre: 'Gavilan Dorsirrojo',
        nombreCientifico: 'Parabuteo unicinctus',
        descripcion: 'Ave rapaz conocida por su caza cooperativa y visi√≥n extremadamente aguda. Trabaja en grupos para capturar presas.',
        habitat: 'Zonas semi√°ridas, matorrales',
        tama√±o: '46-76 cm',
        peso: '0.5-1.3 kg',
        icono: 'ü¶Ö',
        categoria: 'Rapaz',
        imagen: 'imagenes/Gavilan-dorsirrojo.png'
    },

    13: { // Gaviota Andina
        nombre: 'Gaviota Andina',
        nombreCientifico: 'Chroicocephalus serranus',
        descripcion: 'Gaviota adaptada al fr√≠o andino con coloraci√≥n que var√≠a seg√∫n la estaci√≥n. End√©mica de los Andes sudamericanos.',
        habitat: 'Lagos y lagunas altoandinas',
        tama√±o: '42-48 cm',
        peso: '250-400 g',
        icono: 'üïäÔ∏è',
        categoria: 'Acu√°tica',
        imagen: 'imagenes/Gaviota-andina.JPG'
    },

    14: { // Golondrina Andina
        nombre: 'Golondrina Andina',
        nombreCientifico: 'Orochelidon andecola',
        descripcion: 'Golondrina con vuelo r√°pido y gran adaptaci√≥n a la altura. Migra siguiendo patrones estacionales en los Andes.',
        habitat: 'Valles andinos, quebradas',
        tama√±o: '12-14 cm',
        peso: '10-15 g',
        icono: 'üê¶',
        categoria: 'Insect√≠vora',
        imagen: 'imagenes/Golondrina-andina.png'
    },

    15: { // Huallata
        nombre: 'Huallata',
        nombreCientifico: 'Chloephaga melanoptera',
        descripcion: 'Ganso andino con sonido distintivo y comportamiento muy sociable. Forma grandes bandadas en √©poca de reproducci√≥n.',
        habitat: 'Bofedales, puna h√∫meda',
        tama√±o: '75-80 cm',
        peso: '2.5-3.2 kg',
        icono: 'ü¶Ü',
        categoria: 'Acu√°tica',
        imagen: 'imagenes/Wallata-Ganzo-andino.jpg'
    },

    16: { // Leke Leke
        nombre: 'Leke Leke',
        nombreCientifico: 'Vanellus resplendens',
        descripcion: 'Ave con vocalizaci√≥n muy fuerte y defensa activa de su territorio. Su nombre imita su llamado caracter√≠stico.',
        habitat: 'Pastizales, bofedales, puna',
        tama√±o: '32-38 cm',
        peso: '140-200 g',
        icono: 'üê¶',
        categoria: 'Lim√≠cola',
        imagen: 'imagenes/Lequecho-Avefria-andina.JPG'
    },

    17: { // Minero de Puna
        nombre: 'Minero de Puna',
        nombreCientifico: 'Geositta punensis',
        descripcion: 'Ave principalmente terrestre que construye nidos en cuevas. Especialista en locomoci√≥n por el suelo de la puna.',
        habitat: 'Puna seca, laderas rocosas',
        tama√±o: '14-16 cm',
        peso: '18-25 g',
        icono: 'üê¶',
        categoria: 'Insect√≠vora',
        imagen: 'imagenes/Minero-puna.png'
    },

    18: { // Parihuana
        nombre: 'Parihuana',
        nombreCientifico: 'Phoenicoparrus andinus',
        descripcion: 'Flamenco filtrador natural cuya coloraci√≥n rosada proviene de su dieta rica en carotenoides. Ave nacional del Per√∫.',
        habitat: 'Lagunas salinas altoandinas',
        tama√±o: '102-110 cm',
        peso: '2.0-2.8 kg',
        icono: 'ü¶©',
        categoria: 'Acu√°tica',
        imagen: 'imagenes/Parihuana.png'
    },

    19: { // Parpadeo Andino
        nombre: 'Parpadeo Andino',
        nombreCientifico: 'Colaptes rupicola',
        descripcion: 'Carpintero especialista en hormigas con peso de 100-120g. Se alimenta principalmente de insectos que extrae de grietas rocosas.',
        habitat: 'Zonas rocosas, puna con arbustos',
        tama√±o: '32-36 cm',
        peso: '100-120 g',
        icono: 'üê¶',
        categoria: 'Insect√≠vora',
        imagen: 'imagenes/Carpintero-andino.JPG'
    },

    20: { // Pata Amarilla Menor
        nombre: 'Pata Amarilla Menor',
        nombreCientifico: 'Tringa flavipes',
        descripcion: 'Ave migratoria de gran resistencia que prefiere aguas someras. Realiza uno de los viajes m√°s largos del reino animal.',
        habitat: 'Orillas de lagos, humedales',
        tama√±o: '22-25 cm',
        peso: '67-94 g',
        icono: 'üê¶',
        categoria: 'Lim√≠cola',
        imagen: 'imagenes/Pata-amarilla-menor.png'
    },

    21: { // Pato Puna
        nombre: 'Pato Puna',
        nombreCientifico: 'Spatula puna',
        descripcion: 'Pato filtrador especialista en lagunas de altura. Perfectamente adaptado a las condiciones extremas de la puna andina.',
        habitat: 'Lagunas altoandinas, bofedales',
        tama√±o: '45-48 cm',
        peso: '500-700 g',
        icono: 'ü¶Ü',
        categoria: 'Acu√°tica',
        imagen: 'imagenes/Pato-puna.JPG'
    },

    22: { // Pato Rana
        nombre: 'Pato Rana',
        nombreCientifico: 'Oxyura ferruginea',
        descripcion: 'Pato de alimentaci√≥n acu√°tica, discreto y poco visible. Excelente buceador que pasa la mayor parte del tiempo sumergido.',
        habitat: 'Lagos profundos, lagunas',
        tama√±o: '35-43 cm',
        peso: '300-500 g',
        icono: 'ü¶Ü',
        categoria: 'Acu√°tica',
        imagen: 'imagenes/Pato-rana.JPG'
    },

    23: { // Pato Colorado
        nombre: 'Pato Colorado',
        nombreCientifico: 'Spatula cyanoptera',
        descripcion: 'Pato con coloraci√≥n brillante pero dif√≠cil de observar debido a sus h√°bitos reservados. Los machos muestran colores intensos durante el cortejo.',
        habitat: 'Lagunas con vegetaci√≥n, humedales',
        tama√±o: '37-41 cm',
        peso: '250-400 g',
        icono: 'ü¶Ü',
        categoria: 'Acu√°tica',
        imagen: 'imagenes/pato_sutro2.jpg'
    },

    24: { // Pincha Flores de Garganta Negra
        nombre: 'Pincha Flores de Garganta Negra',
        nombreCientifico: 'Diglossa brunneiventris',
        descripcion: 'Ave con especializaci√≥n alimentaria √∫nica en h√°bitat altoandino. Su pico est√° adaptado para extraer n√©ctar perforando las flores.',
        habitat: 'Bosques nublados, matorrales andinos',
        tama√±o: '12-13 cm',
        peso: '8-12 g',
        icono: 'üå∫',
        categoria: 'Nectar√≠vora',
        imagen: 'imagenes/Pinchaflores-garganta-negra.png'
    },

    25: { // Pinz√≥n Sierra Peruano
        nombre: 'Pinzon Sierra Peruano',
        nombreCientifico: 'Phrygilus punensis',
        descripcion: 'Ave gran√≠vora adaptada al fr√≠o extremo de la sierra. Su alimentaci√≥n se basa principalmente en semillas de plantas altoandinas.',
        habitat: 'Puna, laderas rocosas',
        tama√±o: '14-16 cm',
        peso: '15-25 g',
        icono: 'üê¶',
        categoria: 'Gran√≠vora',
        imagen: 'imagenes/Pinz√≥n-sierra-peruano.png'
    },

    26: { // Rasc√≥n Plomizo
        nombre: 'Rasc√≥n Plomizo',
        nombreCientifico: 'Pardirallus sanguinolentus',
        descripcion: 'Ave dif√≠cil de avistar con dieta muy variada. Prefiere mantenerse oculta entre la vegetaci√≥n densa de los humedales.',
        habitat: 'Totorales, humedales con vegetaci√≥n',
        tama√±o: '33-38 cm',
        peso: '350-500 g',
        icono: 'üê¶',
        categoria: 'Omn√≠vora',
        imagen: 'imagenes/Rasc√≥nplomizo.png'
    },

    27: { // Zambullidor del Titicaca
        nombre: 'Zambullidor del Titicaca',
        nombreCientifico: 'Rollandia Microptera',
        descripcion: 'Ave end√©mica con alimentaci√≥n subacu√°tica y plumaje denso e impermeable. Especie emblem√°tica del Lago Titicaca.',
        habitat: 'Lago Titicaca exclusivamente',
        tama√±o: '40-45 cm',
        peso: '600-900 g',
        icono: 'ü¶Ü',
        categoria: 'Acu√°tica',
        estado: 'En peligro cr√≠tico',
        imagen: 'imagenes/Zambullidor.png'
    },

    28: { // Zampull√≠n Plateado
        nombre: 'Zampull√≠n Plateado',
        nombreCientifico: 'Podiceps Occipitalis',
        descripcion: 'Ave acu√°tica con plumaje plateado distintivo. Es discreto pero curioso, a menudo se acerca a observar a los visitantes.',
        habitat: 'Lagos y lagunas andinas',
        tama√±o: '26-30 cm',
        peso: '250-400 g',
        icono: 'ü¶Ü',
        categoria: 'Acu√°tica',
        imagen: 'imagenes/zampullin_plateado2.jpg'
    },

    29: { // Zarapito Picolargo
        nombre: 'Zarapito Picolargo',
        nombreCientifico: 'Numenius phaeopus',
        descripcion: 'Ave con alimentaci√≥n especializada y gran resistencia para migraciones largas. Su pico curvado le permite explorar diferentes tipos de suelo.',
        habitat: 'Costas, humedales, pastizales',
        tama√±o: '40-46 cm',
        peso: '270-493 g',
        icono: 'üê¶',
        categoria: 'Lim√≠cola',
        imagen: 'imagenes/Zarapito-picolargo.png'
    },

    // Nota: He incluido solo 3 especies para el ejemplo. 
        30: { // Ibis de la puna
    nombre: 'Ibis de la puna',
    nombreCientifico: 'Plegadis ridgwayi',
    descripcion: 'Ave de pico curvo, adaptada a zonas h√∫medas, con plumaje iridiscente que refleja distintos tonos seg√∫n la luz.',
    habitat: 'Humedales altoandinos',
    tama√±o: '60-70 cm',
    peso: '600-750 g',
    icono: 'ü™∂',
    categoria: 'Ibis',
    imagen: 'imagenes/Puna-ibis.JPG'
},
        31: { // Totorero
            nombre: 'Totorero',
            nombreCientifico: 'Phleocryptes melanops',
            descripcion: 'Ave que habita en juncales, reconocida por su canto complejo y nidos colgantes entre las totoras.',
            habitat: 'Juncales, humedales',
            tama√±o: '12-13 cm',
            peso: '9-12 g',
            icono: 'üé∂',
            categoria: 'Furn√°ridos',
            imagen: 'imagenes/Totorero.JPG'
        },
        32: { // Rasc√≥n plomizo
            nombre: 'Rasc√≥n plomizo',
            nombreCientifico: 'Pardirallus sanguinolentus',
            descripcion: 'Ave de h√°bitat palustre, con plumaje gris plomizo y pico largo adaptado para buscar alimento en zonas h√∫medas.',
            habitat: 'Humedales y pajonales',
            tama√±o: '30-35 cm',
            peso: '200-300 g',
            icono: 'üåø',
            categoria: 'R√°lidos',
            imagen: 'imagenes/Rascon-plomizo.JPG'
        },
        33: { // Negrito
            nombre: 'Negrito',
            nombreCientifico: 'Lessonia oreas',
            descripcion: 'Ave de altitudes elevadas, con plumaje oscuro y adaptaciones para ambientes fr√≠os y rocosos.',
            habitat: 'Zonas altoandinas',
            tama√±o: '12-15 cm',
            peso: '15-20 g',
            icono: '‚¨õ',
            categoria: 'Tir√°nidos',
            imagen: 'imagenes/Negrito.jpeg'
        },
        34: { // Gallareta andina
            nombre: 'Gallareta andina',
            nombreCientifico: 'Fulica ardesiaca',
            descripcion: 'Ave acu√°tica de lagos altoandinos, con pico blanco y patas lobuladas que le permiten nadar con facilidad.',
            habitat: 'Lagos altoandinos',
            tama√±o: '35-45 cm',
            peso: '400-700 g',
            icono: '‚ö™',
            categoria: 'R√°lidos',
            imagen: 'imagenes/Gallareta-Andina.JPG'
        },
        35: { // Cern√≠calo americano
            nombre: 'Cern√≠calo americano',
            nombreCientifico: 'Falco sparverius',
            descripcion: 'Peque√±o halc√≥n con vuelo cernido, visi√≥n aguda y h√°bitos cazadores de insectos y peque√±os vertebrados.',
            habitat: 'Campos abiertos y zonas urbanas',
            tama√±o: '22-27 cm',
            peso: '80-165 g',
            icono: 'ü¶Ö',
            categoria: 'Falconiformes',
            imagen: 'imagenes/Cernicalo-americano.JPG'
        },
        36: { // Paloma dom√©stica
            nombre: 'Paloma dom√©stica',
            nombreCientifico: 'Columba livia',
            descripcion: 'Ave ampliamente distribuida y adaptable a entornos urbanos, famosa por su capacidad de orientaci√≥n.',
            habitat: '√Åreas urbanas y rurales',
            tama√±o: '30-35 cm',
            peso: '250-380 g',
            icono: 'üïäÔ∏è',
            categoria: 'Col√∫mbidos',
            imagen: 'imagenes/Paloma-domestica.JPG'
        },
        37: { // Playero de Baird
            nombre: 'Playero de Baird',
            nombreCientifico: 'Calidris bairdii',
            descripcion: 'Ave migratoria que recorre largas distancias, se alimenta en playas arenosas y suele hacerlo en grupo.',
            habitat: 'Playas y humedales costeros',
            tama√±o: '18-20 cm',
            peso: '40-50 g',
            icono: 'üåä',
            categoria: 'Lim√≠cola',
            imagen: 'imagenes/Playero.jpeg'
        },
        38: { // Lechuza terrestre
            nombre: 'Lechuza terrestre',
            nombreCientifico: 'Athene cunicularia',
            descripcion: 'Ave rapaz nocturna que anida en madrigueras, con plumaje cr√≠ptico y excelente visi√≥n nocturna.',
            habitat: 'Praderas, zonas √°ridas',
            tama√±o: '23-28 cm',
            peso: '150-250 g',
            icono: 'ü¶â',
            categoria: 'Estr√≠gidos',
            imagen: 'imagenes/Lechuza-terrestre.jpeg'
        },
        39: { // Bailar√≠n chico
            nombre: 'Bailar√≠n chico',
            nombreCientifico: 'Anthus furcatus',
            descripcion: 'Ave peque√±a de tierras abiertas, con pico corto y plumaje que le da camuflaje.',
            habitat: 'Praderas y pastizales',
            tama√±o: '14-16 cm',
            peso: '20-25 g',
            icono: 'üéµ',
            categoria: 'Motac√≠lidos',
            imagen: 'imagenes/Bailarin-chico.jpg'
        },
        40: { // Pato jerg√≥n
            nombre: 'Pato jerg√≥n',
            nombreCientifico: 'Anas georgica',
            descripcion: 'Pato migratorio de h√°bitat acu√°tico, con pico amarillo y gran adaptabilidad a lagunas altoandinas.',
            habitat: 'Lagos, lagunas y r√≠os',
            tama√±o: '45-56 cm',
            peso: '500-800 g',
            icono: 'ü¶Ü',
            categoria: 'An√°tidos',
            imagen: 'imagenes/Pato-gergon.jpg'
        },
        41: { // Varillero ala amarilla (macho)
            nombre: 'Varillero ala amarilla (macho)',
            nombreCientifico: 'Agelasticus thilius',
            descripcion: 'Ave de plumaje negro con alas amarillas muy visibles; los machos suelen ser territoriales.',
            habitat: 'Humedales y pantanos',
            tama√±o: '18-20 cm',
            peso: '35-40 g',
            icono: 'üíõ',
            categoria: 'Ict√©ridos',
            imagen: 'imagenes/agelasticus-thilius.jpeg'
        },
        42: { // Varillero ala amarilla (hembra)
            nombre: 'Varillero ala amarilla (hembra)',
            nombreCientifico: 'Agelasticus thilius',
            descripcion: 'Ave con alas amarillas y canto melodioso; la hembra presenta plumaje m√°s cr√≠ptico y adaptado al entorno.',
            habitat: 'Humedales y pantanos',
            tama√±o: '17-19 cm',
            peso: '30-38 g',
            icono: 'üíõ',
            categoria: 'Ict√©ridos',
            imagen: 'imagenes/Varillero-ala-amarilla.JPG'
        }
        // Nota: He incluido solo 3 especies para el ejemplo. 
        // Puedes a√±adir el resto manteniendo la misma estructura.
    };

    // Variables globales
    let imagenSeleccionada = '';
    let imagenesDisponibles = [];
    let piezas = [];
    let dificultad = 3;
    let tiempoInicio = null;
    let tiempoJuego = null;
    let movimientos = 0;
    let puzzlesCompletados = parseInt(localStorage.getItem('puzzlesCompletados') || '0');
    let mejorTiempo = localStorage.getItem('mejorTiempo') || null;
    let juegoIniciado = false;

    // Funci√≥n principal para verificar im√°genes disponibles
    async function verificarImagenesDisponibles() {
    imagenesDisponibles = [];
    
    const mensaje = document.getElementById('mensaje');
    mensaje.innerHTML = 'üîç <span class="loading">‚è≥</span> Verificando im√°genes disponibles...';
    mensaje.className = 'warning';

    let imagenesEncontradas = 0;
    const totalImagenes = Object.keys(avesData).length;
    
    console.log('=== INICIO VERIFICACI√ìN DE IM√ÅGENES ===');
    console.log('Total de aves a verificar:', totalImagenes);

    // Verificar cada ave en avesData
    for (const [id, ave] of Object.entries(avesData)) {
        console.log(`\n--- Verificando Ave ID: ${id} ---`);
        console.log('Nombre:', ave.nombre);
        console.log('Ruta imagen:', ave.imagen);
        
        try {
            const disponible = await verificarImagenIndividual(ave.imagen, id);
            if (disponible) {
                imagenesDisponibles.push(id);
                imagenesEncontradas++;
                console.log(`‚úÖ ${ave.nombre} - DISPONIBLE`);
            } else {
                console.log(`‚ùå ${ave.nombre} - NO DISPONIBLE`);
                console.log('Posibles causas:');
                console.log('  ‚Ä¢ El archivo no existe en la ruta especificada');
                console.log('  ‚Ä¢ El nombre del archivo no coincide exactamente');
                console.log('  ‚Ä¢ El formato no es compatible');
                console.log('  ‚Ä¢ Hay espacios o caracteres especiales en el nombre');
            }
        } catch (error) {
            console.log(`‚ùå ${ave.nombre} - ERROR:`, error);
        }
    }

    console.log('\n=== RESUMEN FINAL ===');
    console.log('Im√°genes disponibles:', imagenesEncontradas);
    console.log('IDs disponibles:', imagenesDisponibles);

    // Actualizar estad√≠sticas
    document.getElementById('available-birds').textContent = imagenesDisponibles.length;
    document.getElementById('puzzles-completed').textContent = puzzlesCompletados;
    document.getElementById('best-time').textContent = mejorTiempo || '--:--';

    // Crear galer√≠a
    crearGaleria();

    // Mostrar resultado
    if (imagenesDisponibles.length === 0) {
        mensaje.innerHTML = `‚ùå No se encontraron im√°genes v√°lidas.<br>
            <small>Por favor, revisa la consola del navegador (F12) para ver detalles espec√≠ficos de cada imagen.</small>`;
        mensaje.className = 'error';
        
        // Deshabilitar botones
        document.querySelectorAll('button').forEach(btn => {
            if (!btn.classList.contains('btn-info')) {
                btn.disabled = true;
            }
        });
        return;
    }

    mensaje.innerHTML = `‚úÖ ${imagenesDisponibles.length} de ${totalImagenes} aves disponibles para jugar<br>
        <small>Revisa la consola (F12) para ver detalles de las im√°genes no encontradas.</small>`;
    mensaje.className = 'success';

    // Inicializar juego despu√©s de un breve delay
    setTimeout(() => {
        mensaje.innerHTML = '';
        mensaje.className = '';
        iniciarJuego();
    }, 3000);
}

    // Funci√≥n para verificar una imagen individual
    function verificarImagenIndividual(rutaImagen, id) {
    return new Promise((resolve) => {
        const img = new Image();
        
        const timeout = setTimeout(() => {
            console.log(`‚è±Ô∏è Timeout para imagen ID ${id}: ${rutaImagen}`);
            resolve(false);
        }, 8000); // Aumentado a 8 segundos
        
        img.onload = () => {
            clearTimeout(timeout);
            // Verificar que la imagen tenga dimensiones v√°lidas
            if (img.naturalWidth > 0 && img.naturalHeight > 0) {
                console.log(`‚úÖ Imagen cargada correctamente - ID ${id}:`, {
                    width: img.naturalWidth,
                    height: img.naturalHeight,
                    src: img.src
                });
                resolve(true);
            } else {
                console.log(`‚ùå Imagen sin dimensiones v√°lidas - ID ${id}`);
                resolve(false);
            }
        };
        
        img.onerror = (error) => {
            clearTimeout(timeout);
            console.log(`‚ùå Error cargando imagen ID ${id}:`, {
                src: img.src,
                error: error,
                message: 'Posibles causas: archivo no existe, formato no soportado, problema de permisos'
            });
            resolve(false);
        };
        
        // Configurar la imagen
        img.crossOrigin = 'anonymous';
        
        // Intentar diferentes variaciones del nombre de archivo
        const rutasAIntentar = [
            rutaImagen,
            rutaImagen.toLowerCase(),
            rutaImagen.replace(/\s+/g, '_'),
            rutaImagen.replace(/\s+/g, '-'),
            rutaImagen.replace(/\s+/g, '')
        ];
        
        let intentoActual = 0;
        
        function intentarSiguienteRuta() {
            if (intentoActual < rutasAIntentar.length) {
                const rutaActual = rutasAIntentar[intentoActual];
                console.log(`üìç Intentando ruta ${intentoActual + 1}/${rutasAIntentar.length} para ID ${id}: ${rutaActual}`);
                img.src = rutaActual;
                intentoActual++;
            }
        }
        
        // Modificar el evento de error para intentar m√∫ltiples rutas
        img.onerror = () => {
            if (intentoActual < rutasAIntentar.length) {
                setTimeout(intentarSiguienteRuta, 100);
            } else {
                clearTimeout(timeout);
                console.log(`‚ùå Todas las rutas fallaron para ID ${id}:`, rutasAIntentar);
                resolve(false);
            }
        };
        
        // Comenzar con la primera ruta
        intentarSiguienteRuta();
    });
}

function verificarArchivosEspecificos() {
    console.log('\n=== VERIFICACI√ìN MANUAL DE ARCHIVOS ===');
    
    // Lista de archivos que parecen estar causando problemas
    const archivosProblematicos = [
        'imagenes/√°guila ratonera pechinegra en puno.png',
        'imagenes/Aguilucho negro.png',
        'imagenes/Avocetaandina.png',
        'imagenes/Charadrius alticola - Chorlito pune√±o - Puna plower.jpg',
        'imagenes/Gallinulamorada.png'
    ];
    
    archivosProblematicos.forEach((archivo, index) => {
        const img = new Image();
        img.onload = () => {
            console.log(`‚úÖ Archivo ${index + 1} OK:`, archivo);
        };
        img.onerror = () => {
            console.log(`‚ùå Archivo ${index + 1} FALLO:`, archivo);
        };
        img.src = archivo;
    });
}

    // Funci√≥n para seleccionar un ave espec√≠fica
    function seleccionarAve(id) {
        if (!imagenesDisponibles.includes(id)) {
            const ave = avesData[id];
            alert(`‚ùå La imagen "${ave.nombre}" no est√° disponible.\nPor favor, a√±ade el archivo "${ave.imagen}" a tu proyecto.`);
            return;
        }

        // Actualizar selecci√≥n visual
        document.querySelectorAll('.gallery-item').forEach(item => {
            item.classList.remove('selected');
        });
        
        // Encontrar y marcar el elemento seleccionado
        const elementos = document.querySelectorAll('.gallery-item');
        elementos.forEach(item => {
            if (item.dataset.birdId === id) {
                item.classList.add('selected');
            }
        });

        imagenSeleccionada = id;
        iniciarJuego();
    }

    // Funci√≥n para crear la galer√≠a de aves
    function crearGaleria() {
    const galeria = document.getElementById('bird-gallery');
    galeria.innerHTML = '';

    Object.entries(avesData).forEach(([id, ave]) => {
        const disponible = imagenesDisponibles.includes(id);
        
        const item = document.createElement('div');
        item.className = `gallery-item ${disponible ? '' : 'unavailable'}`;
        item.dataset.birdId = id;
        
        if (disponible) {
            item.onclick = () => seleccionarAve(id);
            item.title = `Click para jugar con ${ave.nombre}`;
        } else {
            item.title = `${ave.nombre} - Imagen no disponible`;
        }
        
        // Crear miniatura de imagen si est√° disponible
        let imagenMiniatura = '';
        if (disponible) {
            imagenMiniatura = `
                <div style="width: 60px; height: 60px; margin: 0 auto 10px; background-image: url(${ave.imagen}); background-size: cover; background-position: center; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.2); border: 2px solid #27ae60;">
                </div>
            `;
        } else {
            // Mostrar informaci√≥n de debug para im√°genes no disponibles
            imagenMiniatura = `
                <div style="width: 60px; height: 60px; margin: 0 auto 10px; background-color: #ecf0f1; border: 2px dashed #e74c3c; border-radius: 8px; display: flex; align-items: center; justify-content: center; font-size: 1.5em;">
                    ${ave.icono}
                </div>
                <div style="font-size: 0.6em; color: #e74c3c; margin-bottom: 5px; word-break: break-all;">
                    ${ave.imagen}
                </div>
            `;
        }
        
        item.innerHTML = `
            ${imagenMiniatura}
            <div class="gallery-name">${ave.nombre}</div>
            <div style="font-size: 0.8em; color: #7f8c8d; margin: 5px 0;">${ave.categoria}</div>
            ${ave.estado ? `<div style="font-size: 0.7em; color: #e74c3c; font-weight: bold;">‚ö†Ô∏è ${ave.estado}</div>` : ''}
            <div class="gallery-status ${disponible ? 'available' : 'unavailable-text'}">
                ${disponible ? '‚úÖ Disponible' : '‚ùå Archivo no encontrado'}
            </div>
        `;
        
        galeria.appendChild(item);
    });
}

    // Funci√≥n para iniciar el juego
    function iniciarJuego() {
    if (imagenesDisponibles.length === 0) {
        const mensaje = document.getElementById('mensaje');
        mensaje.innerHTML = '‚ùå No hay im√°genes disponibles para jugar';
        mensaje.className = 'error';
        return;
    }

    const puzzle = document.getElementById('puzzle');
    puzzle.innerHTML = '';
    const mensaje = document.getElementById('mensaje');
    mensaje.textContent = '';
    mensaje.className = '';

    // Si no hay imagen seleccionada, seleccionar una aleatoria
    if (!imagenSeleccionada || !imagenesDisponibles.includes(imagenSeleccionada)) {
        imagenSeleccionada = imagenesDisponibles[Math.floor(Math.random() * imagenesDisponibles.length)];
    }

    // Actualizar informaci√≥n del ave
    actualizarInfoAve();

    // Resetear variables del juego
    piezas = [];
    movimientos = 0;
    document.getElementById('moves-count').textContent = movimientos;

    // Configurar el puzzle
    const tama√±o = 120 * 3 / dificultad;
    puzzle.style.gridTemplateColumns = `repeat(${dificultad}, ${tama√±o}px)`;
    puzzle.style.gridTemplateRows = `repeat(${dificultad}, ${tama√±o}px)`;

    // Crear array de piezas
    for (let i = 0; i < dificultad * dificultad; i++) {
        piezas.push(i);
    }

    // Mezclar piezas
    do {
        piezas.sort(() => Math.random() - 0.5);
    } while (estaResuelto());

    // Obtener la ruta de la imagen
    const rutaImagen = avesData[imagenSeleccionada].imagen;

    // Mostrar mensaje de carga mientras se prepara el puzzle
    mensaje.innerHTML = 'üîÑ Preparando puzzle...';
    mensaje.className = 'warning';

    // Precargar la imagen antes de crear las piezas
    const img = new Image();
    img.onload = () => {
        // Limpiar mensaje de carga
        mensaje.innerHTML = '';
        mensaje.className = '';
        
        // Crear las piezas del puzzle
        piezas.forEach((pos, index) => {
            const pieza = document.createElement('div');
            pieza.classList.add('piece');
            pieza.style.width = `${tama√±o}px`;
            pieza.style.height = `${tama√±o}px`;
            pieza.style.backgroundImage = `url(${rutaImagen})`;
            pieza.style.backgroundSize = `${tama√±o * dificultad}px ${tama√±o * dificultad}px`;
            pieza.style.backgroundPosition = `${-(pos % dificultad) * tama√±o}px ${-Math.floor(pos / dificultad) * tama√±o}px`;
            pieza.setAttribute('data-pos', pos);
            pieza.setAttribute('data-index', index);

            // Eventos para arrastrar y soltar
            pieza.draggable = true;
            pieza.addEventListener('dragstart', arrastrar);
            pieza.addEventListener('dragover', permitirSoltar);
            pieza.addEventListener('drop', soltar);

            // Eventos t√°ctiles para m√≥viles
            pieza.addEventListener('touchstart', iniciarTouch, { passive: false });
            pieza.addEventListener('touchmove', moverTouch, { passive: false });
            pieza.addEventListener('touchend', finalizarTouch, { passive: false });

            puzzle.appendChild(pieza);
        });
    };
    
    img.onerror = () => {
        mensaje.innerHTML = `‚ùå Error cargando la imagen: ${avesData[imagenSeleccionada].nombre}`;
        mensaje.className = 'error';
    };
    
    img.src = rutaImagen;

    // Iniciar el temporizador
    tiempoInicio = Date.now();
    if (tiempoJuego) clearInterval(tiempoJuego);
    tiempoJuego = setInterval(actualizarTimer, 1000);
    juegoIniciado = true;
}

    // Funci√≥n para verificar si el puzzle est√° resuelto (para evitar configuraci√≥n ganadora inicial)
    function estaResuelto() {
        return piezas.every((pos, index) => pos === index);
    }

    // Funci√≥n para actualizar informaci√≥n del ave
    function actualizarInfoAve() {
    const info = avesData[imagenSeleccionada];
    if (!info) return;

    document.getElementById('bird-name').textContent = info.nombre;
    document.getElementById('bird-description').innerHTML = `
        <strong>Nombre cient√≠fico:</strong> ${info.nombreCientifico}<br>
        <strong>Descripci√≥n:</strong> ${info.descripcion}<br>
        <strong>H√°bitat:</strong> ${info.habitat}<br>
        <strong>Tama√±o:</strong> ${info.tama√±o}<br>
        <strong>Peso:</strong> ${info.peso}<br>
        <strong>Categor√≠a:</strong> ${info.categoria}
        ${info.estado ? `<br><strong>Estado:</strong> <span style="color: #e74c3c; font-weight: bold;">${info.estado}</span>` : ''}
    `;
    
    // Mostrar imagen de vista previa
    const preview = document.getElementById('bird-preview');
    if (imagenesDisponibles.includes(imagenSeleccionada)) {
        preview.style.backgroundImage = `url(${info.imagen})`;
        preview.innerHTML = ''; // Limpiar el emoji
    } else {
        preview.style.backgroundImage = '';
        preview.innerHTML = info.icono;
    }
}

    // Funci√≥n para actualizar el temporizador
    function actualizarTimer() {
        if (tiempoInicio && juegoIniciado) {
            const tiempoTranscurrido = Math.floor((Date.now() - tiempoInicio) / 1000);
            const minutos = Math.floor(tiempoTranscurrido / 60).toString().padStart(2, '0');
            const segundos = (tiempoTranscurrido % 60).toString().padStart(2, '0');
            document.getElementById('timer').textContent = `‚è±Ô∏è Tiempo: ${minutos}:${segundos}`;
        }
    }

    // Variables para control t√°ctil
    let elementoTocado = null;
    let posicionInicial = { x: 0, y: 0 };

    function iniciarTouch(e) {
        e.preventDefault();
        elementoTocado = e.target;
        const touch = e.touches[0];
        posicionInicial = { x: touch.clientX, y: touch.clientY };
        elementoTocado.style.zIndex = '1000';
        elementoTocado.style.transform = 'scale(1.1)';
        elementoTocado.style.boxShadow = '0 15px 30px rgba(0, 0, 0, 0.4)';
    }

    function moverTouch(e) {
        e.preventDefault();
        if (!elementoTocado) return;
        
        const touch = e.touches[0];
        const deltaX = touch.clientX - posicionInicial.x;
        const deltaY = touch.clientY - posicionInicial.y;
        
        elementoTocado.style.position = 'relative';
        elementoTocado.style.left = deltaX + 'px';
        elementoTocado.style.top = deltaY + 'px';
    }

    function finalizarTouch(e) {
        e.preventDefault();
        if (!elementoTocado) return;

        const touch = e.changedTouches[0];
        const elementoDestino = document.elementFromPoint(touch.clientX, touch.clientY);
        
        // Resetear estilos
        elementoTocado.style.position = '';
        elementoTocado.style.left = '';
        elementoTocado.style.top = '';
        elementoTocado.style.zIndex = '';
        elementoTocado.style.transform = '';
        elementoTocado.style.boxShadow = '';

        if (elementoDestino && elementoDestino.classList.contains('piece') && elementoDestino !== elementoTocado) {
            intercambiarPiezas(elementoTocado, elementoDestino);
        }

        elementoTocado = null;
    }

    // Funciones de arrastrar y soltar
    function arrastrar(e) {
        e.dataTransfer.setData('text', e.target.getAttribute('data-index'));
    }

    function permitirSoltar(e) {
        e.preventDefault();
    }

    function soltar(e) {
        e.preventDefault();
        const origenIndex = e.dataTransfer.getData('text');
        const destinoIndex = e.target.getAttribute('data-index');

        if (origenIndex === destinoIndex) return;

        const piezasDivs = document.querySelectorAll('.piece');
        const origenDiv = piezasDivs[origenIndex];
        const destinoDiv = piezasDivs[destinoIndex];

        intercambiarPiezas(origenDiv, destinoDiv);
    }

    // Funci√≥n para intercambiar piezas
    function intercambiarPiezas(origenDiv, destinoDiv) {
        const origenIndex = parseInt(origenDiv.getAttribute('data-index'));
        const destinoIndex = parseInt(destinoDiv.getAttribute('data-index'));

        // Intercambiar posiciones en el array
        const temp = piezas[origenIndex];
        piezas[origenIndex] = piezas[destinoIndex];
        piezas[destinoIndex] = temp;

        // Actualizar visual
        actualizarPiezaVisual(origenDiv, piezas[origenIndex]);
        actualizarPiezaVisual(destinoDiv, piezas[destinoIndex]);

        // Incrementar contador de movimientos
        movimientos++;
        document.getElementById('moves-count').textContent = movimientos;

        // Comprobar si est√° resuelto
        verificarVictoria();
    }

    // Funci√≥n para actualizar la visualizaci√≥n de una pieza
    function actualizarPiezaVisual(elemento, posicion) {
        const tama√±o = 120 * 3 / dificultad;
        elemento.style.backgroundPosition = `${-(posicion % dificultad) * tama√±o}px ${-Math.floor(posicion / dificultad) * tama√±o}px`;
        elemento.setAttribute('data-pos', posicion);
    }

    // Funci√≥n para verificar si se gan√≥
    function verificarVictoria() {
        const correcto = piezas.every((pos, index) => pos === index);

        if (correcto) {
            juegoIniciado = false;
            clearInterval(tiempoJuego);
            
            const tiempoFinal = Math.floor((Date.now() - tiempoInicio) / 1000);
            const minutos = Math.floor(tiempoFinal / 60).toString().padStart(2, '0');
            const segundos = (tiempoFinal % 60).toString().padStart(2, '0');
            const tiempoFormateado = `${minutos}:${segundos}`;

            // Actualizar estad√≠sticas
            puzzlesCompletados++;
            localStorage.setItem('puzzlesCompletados', puzzlesCompletados);
            document.getElementById('puzzles-completed').textContent = puzzlesCompletados;

            // Actualizar mejor tiempo
            let esMejorTiempo = false;
            
            if (!mejorTiempo) {
                esMejorTiempo = true;
                mejorTiempo = tiempoFormateado;
            } else {
                const [minMejor, segMejor] = mejorTiempo.split(':').map(Number);
                const tiempoMejorSegundos = minMejor * 60 + segMejor;
                if (tiempoFinal < tiempoMejorSegundos) {
                    esMejorTiempo = true;
                    mejorTiempo = tiempoFormateado;
                }
            }
            
            if (esMejorTiempo) {
                localStorage.setItem('mejorTiempo', mejorTiempo);
                document.getElementById('best-time').textContent = mejorTiempo;
            }

            const ave = avesData[imagenSeleccionada];
            const mensaje = document.getElementById('mensaje');
            mensaje.innerHTML = `
                üéâ ¬°Felicidades! Has completado el rompecabezas<br>
                <strong>${ave.nombre}</strong><br>
                ‚è±Ô∏è Tiempo: ${tiempoFormateado} | üéØ Movimientos: ${movimientos}
                ${esMejorTiempo ? '<br>üèÜ ¬°Nuevo r√©cord personal!' : ''}
            `;
            mensaje.className = 'success';

            // Efecto de celebraci√≥n
            celebrar();
        }
    }

    // Funci√≥n de celebraci√≥n con confeti
    function celebrar() {
        for (let i = 0; i < 50; i++) {
            setTimeout(() => {
                const confeti = document.createElement('div');
                confeti.style.position = 'fixed';
                confeti.style.top = '-10px';
                confeti.style.left = Math.random() * 100 + '%';
                confeti.style.width = Math.random() * 10 + 5 + 'px';
                confeti.style.height = confeti.style.width;
                confeti.style.backgroundColor = [
                    '#ff6b6b', '#4ecdc4', '#45b7d1', '#96ceb4', 
                    '#feca57', '#ff9ff3', '#54a0ff', '#5f27cd'
                ][Math.floor(Math.random() * 8)];
                confeti.style.borderRadius = Math.random() > 0.5 ? '50%' : '0';
                confeti.style.zIndex = '10000';
                confeti.style.pointerEvents = 'none';
                confeti.style.animation = 'fall 3s linear forwards';
                document.body.appendChild(confeti);

                setTimeout(() => {
                    if (confeti.parentNode) {
                        confeti.remove();
                    }
                }, 3000);
            }, i * 50);
        }
    }

    // Funci√≥n para cambiar dificultad
    function cambiarDificultad(nuevaDificultad) {
        if (nuevaDificultad === dificultad) return;
        
        dificultad = nuevaDificultad;
        
        // Actualizar botones de dificultad
        document.querySelectorAll('.difficulty-btn').forEach(btn => {
            btn.classList.remove('active');
        });
        event.target.classList.add('active');
        
        // Reiniciar juego con nueva dificultad
        if (imagenesDisponibles.length > 0) {
            iniciarJuego();
        }
    }

    // Funci√≥n para cambiar imagen
    function cambiarImagen() {
        if (imagenesDisponibles.length <= 1) {
            alert('‚ùå Solo tienes una imagen disponible.\nA√±ade m√°s im√°genes de aves a la carpeta "imagenes/" para poder cambiar.');
            return;
        }

        // Seleccionar una imagen diferente a la actual
        const imagenesRestantes = imagenesDisponibles.filter(id => id !== imagenSeleccionada);
        imagenSeleccionada = imagenesRestantes[Math.floor(Math.random() * imagenesRestantes.length)];
        
        // Actualizar selecci√≥n en la galer√≠a
        document.querySelectorAll('.gallery-item').forEach(item => {
            item.classList.remove('selected');
            if (item.dataset.birdId === imagenSeleccionada) {
                item.classList.add('selected');
            }
        });
        
        iniciarJuego();
    }

    // Funci√≥n para reiniciar juego
    function reiniciarJuego() {
        if (imagenesDisponibles.length === 0) {
            alert('‚ùå No hay im√°genes disponibles para jugar.\nPor favor, a√±ade im√°genes a la carpeta "imagenes/".');
            return;
        }
        iniciarJuego();
    }
    function configurarManejadorImagenes() {
    // Interceptar errores de carga de im√°genes
    window.addEventListener('error', function(e) {
        if (e.target && e.target.tagName === 'IMG') {
            console.warn('Error cargando imagen:', e.target.src);
            // Mostrar placeholder en caso de error
            if (e.target.id === 'bird-preview') {
                const preview = document.getElementById('bird-preview');
                preview.style.backgroundImage = '';
                preview.innerHTML = avesData[imagenSeleccionada]?.icono || 'üê¶';
            }
        }
    }, true);
}

    // Funci√≥n para mostrar ayuda
    function mostrarAyuda() {
        const ave = avesData[imagenSeleccionada] || { nombre: 'las aves', descripcion: 'Aprende sobre diferentes especies de aves.' };
        
        const ayudaTexto = `üéØ C√≥mo jugar:

1. üñ±Ô∏è Arrastra y suelta las piezas para intercambiar posiciones
2. üì± En m√≥viles: mant√©n presionado y arrastra
3. üñºÔ∏è Forma la imagen completa del ${ave.nombre}
4. üîç Usa la imagen de referencia como gu√≠a
5. ‚è±Ô∏è Intenta completar el puzzle en el menor tiempo posible

üí° Consejos:
‚Ä¢ Comienza por los bordes y esquinas
‚Ä¢ Observa los colores y patrones distintivos
‚Ä¢ Usa la imagen de referencia constantemente
‚Ä¢ Practica con dificultad f√°cil primero
‚Ä¢ ¬°La paciencia es clave!

ü¶Ö Sobre ${ave.nombre}:
${ave.descripcion}

üìä Estad√≠sticas actuales:
‚Ä¢ Puzzles completados: ${puzzlesCompletados}
‚Ä¢ Mejor tiempo: ${mejorTiempo || 'N/A'}
‚Ä¢ Aves disponibles: ${imagenesDisponibles.length}

üíæ Para a√±adir m√°s aves:
Coloca archivos de imagen (.jpg, .png, .gif) en la carpeta 'imagenes/' 
con los nombres exactos especificados en la base de datos del juego.

üéÆ Dificultades:
‚Ä¢ F√°cil (3x3): Perfecto para principiantes
‚Ä¢ Medio (4x4): Un buen desaf√≠o
‚Ä¢ Dif√≠cil (5x5): Para expertos

¬°Disfruta aprendiendo sobre las aves mientras juegas!`;

        alert(ayudaTexto);
    }

    // Funci√≥n de inicializaci√≥n
    function inicializar() {
    // Configurar manejo de errores de im√°genes
    configurarManejadorImagenes();
    
    // Mostrar estad√≠sticas guardadas
    document.getElementById('puzzles-completed').textContent = puzzlesCompletados;
    document.getElementById('best-time').textContent = mejorTiempo || '--:--';
    
    // Mostrar mensaje de carga
    const mensaje = document.getElementById('mensaje');
    mensaje.innerHTML = 'üîÑ Iniciando aplicaci√≥n...';
    mensaje.className = 'warning';
    
    console.log('=== INICIO DE APLICACI√ìN ===');
    console.log('Total de aves en base de datos:', Object.keys(avesData).length);
    console.log('Para ver detalles de verificaci√≥n, abre la consola del navegador (F12)');
    
    // Ejecutar verificaci√≥n manual
    setTimeout(() => {
        verificarArchivosEspecificos();
    }, 500);
    
    // Verificar im√°genes despu√©s de un peque√±o delay
    setTimeout(() => {
        verificarImagenesDisponibles();
    }, 1000);
}

    // Eventos de inicializaci√≥n
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', inicializar);
    } else {
        inicializar();
    }

    // Manejar errores globales de im√°genes
    window.addEventListener('error', function(e) {
        if (e.target && e.target.tagName === 'IMG') {
            console.warn('Error cargando imagen:', e.target.src);
        }
    }, true);

    // Prevenir comportamiento por defecto en m√≥viles para mejorar la experiencia t√°ctil
    document.addEventListener('touchstart', function(e) {
        if (e.target.classList.contains('piece')) {
            e.preventDefault();
        }
    }, { passive: false });

    document.addEventListener('touchmove', function(e) {
        if (e.target.classList.contains('piece')) {
            e.preventDefault();
        }
    }, { passive: false });
</script>

</body>
</html>